PS C:\Users\basav\Downloads\itsm-agent-windows (1)> python .\install_windows.py
ITSM Agent Windows Installation
==================================================

Python version: 3.10.0 (tags/v3.10.0:b494f59, Oct  4 2021, 19:00:18) [MSC v.1929 64 bit (AMD64)]
Platform: Windows-10-10.0.26100-SP0

Installing Python dependencies...
Installing psutil>=5.8.0...
✓ Installed psutil>=5.8.0
Installing requests>=2.28.0...
✓ Installed requests>=2.28.0
Installing configparser>=5.0.0...
✓ Installed configparser>=5.0.0
Installing pywin32>=227...
✓ Installed pywin32>=227

Downloading NSSM for Windows service management...
✓ NSSM already installed

Creating installation directory: C:\Program Files\ITSM Agent
Copying agent files...
✓ Copied itsm_agent.py
✓ Copied system_collector.py
✓ Copied api_client.py
✓ Copied command_scheduler.py
✓ Copied operation_monitor.py
✓ Copied smart_queue.py
✓ Copied service_wrapper.py
✓ Copied config.ini

Agent configuration:
- Configuration file: C:\Program Files\ITSM Agent\config.ini
- Edit the config.ini file to set your API endpoint and authentication
- Default API URL: http://localhost:5000
- Default auth token: dashboard-api-token

Installing Windows service...
Installing service with NSSM...
✗ NSSM service installation failed: E r r o r   c r e a t i n g   s e r v i c e !


 C r e a t e S e r v i c e ( ) :   T h e   s p e c i f i e d   s e r v i c e   a l r e a d y   e x i s t s .






Installing service with Python service wrapper...
✗ Service installation failed: Traceback (most recent call last):
  File "C:\Program Files\ITSM Agent\itsm_agent.py", line 20, in <module>
    from command_scheduler import CommandScheduler
  File "C:\Program Files\ITSM Agent\command_scheduler.py", line 77
    def _validate_command_security(self, command: str) -> Dict[str, Any]:
IndentationError: expected an indented block after 'if' statement on line 74

Error: Failed to install Windows service
Press Enter to exit...
PS C:\Users\basav\Downloads\itsm-agent-windows (1)> python .\fix_windows_service.py
ITSM Agent Windows Service Repair Utility
=========================================

[INFO] Starting service repair process...
[INFO] Stopping ITSM Agent service...
[INFO] Service stopped successfully
[INFO] Deleting ITSM Agent service...
[INFO] Service deleted successfully
[INFO] Cleaning registry entries...
[WARNING] Registry key not found: SYSTEM\CurrentControlSet\Services\ITSMAgent
[INFO] Deleted registry key: SYSTEM\CurrentControlSet\Services\EventLog\Application\ITSMAgent
[INFO] Checking Python installation...
[INFO] Python version: Python 3.10.0
[INFO] Package psutil: OK
[INFO] Package requests: OK
[ERROR] Package pywin32: MISSING
[WARNING] Missing packages: pywin32
[INFO] Installing missing Python packages...
[INFO] Installing psutil...
[INFO] Successfully installed psutil
[INFO] Installing requests...
[INFO] Successfully installed requests
[INFO] Installing pywin32...
[INFO] Successfully installed pywin32
[INFO] Checking Python installation...
[INFO] Python version: Python 3.10.0
[INFO] Package psutil: OK
[INFO] Package requests: OK
[ERROR] Package pywin32: MISSING
[WARNING] Missing packages: pywin32
[ERROR] Python setup failed. Please install required packages manually:
pip install psutil requests pywin32
PS C:\Users\basav\Downloads\itsm-agent-windows (1)>
